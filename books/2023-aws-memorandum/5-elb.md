---
title: "ELB"
---

# ELB (Elastic Load Balancing)とは？
- システムに来たリクエストを、複数のEC2へ負荷分散する仕組み。

# ELBができること
- AZ内での負荷分散
- AZを跨いだ負荷分散
- HTTPSの終端 (後述)
  - User -(HTTPS)- ELB -(HTTP)- EC2群

# ELBの種類
- ALB (Application Load Balancer)
　HTTP, HTTPS(L7)で負荷分散
- NLB (Network Load Balancer)
　TCP, UDP(L3)で負荷分散
- CLB (Classic Load Balancer)
　過去のAWSネットワークで使うロードバランサ

# ターゲットグループ
- ELBで負荷分散させた先を定義したもの

# ターゲットグループの作成
- HTTP(3000)の負荷分散を行う。(Nodeのアプリ)
1. 「EC2」 - 「ロードバランシング」 - 「ターゲットグループ」をクリック
2. 「ターゲットグループの作成」
- 基本的な設定

| 項目                   | 内容                  |
| ---------------------- | --------------------- |
| ターゲットタイプの選択 | インスタンス          |
| ターゲットグループ名   | service-dev-tg (任意) |
| プロトコル : ポート    | HTTP、3000            |
| IP アドレスタイプ      | IPv4                  |
| VPC                    | (作成したVPC)         |
| プロトコルバージョン   |                       |

3. 負荷分散の対象となるEC2群全てを選択し、「保留中として以下を含める」、「ターゲットグループを作成」

# ロードバランサーの作成
1. 「ロードバランサーの作成」
2. ロードバランサータイプ：Application Load Balancer
3. 「作成」

- 基本的な設定

| 項目               | 内容               |
| ------------------ | ------------------ |
| ロードバランサー名 | service-dev-elb    |
| スキーム           | インターネット向け |
| IP アドレスタイプ  | IPv4               |

- ネットワークマッピング

| 項目               | 内容            |
| ------------------ | --------------- |
| VPC | (作成したVPC)   |
|マッピング|(2つの異なるAZのPublic Subnet)|

- セキュリティグループ

| 項目                 | 内容              |
| -------------------- | ----------------- |
| セキュリティグループ | 作成したやつweb用 |

- リスナーとルーティング

| 項目                 | 内容                               |
| -------------------- | ---------------------------------- |
| デフォルトアクション | (作成したターゲットグループを指定) |
